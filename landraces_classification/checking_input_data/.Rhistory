if (addcl2) {
for (i in c(0:no.rep)) {
index1 <- sample(c(1:(2*nrow1)))
rep1[index1] <-  c(1:(2*nrow1))
datRFsyn <- synthetic2(datRF)[index1,]
yy <- datRFsyn[,1]
RF2 <- randomForest(factor(yy)~.,data=datRFsyn[,-1], ntree=no.tree, oob.prox=oob.prox1, proximity=TRUE,do.trace=F,mtry=mtry1,importance=imp)
collect.garbage()
RF2prox <- RF2$proximity[rep1,rep1]
if (i > 0) {
if (i > 1){
xx <- ((RFproxAddcl2 + (RF2prox[c(1:nrow1),c(1:nrow1)]))/i) - (RFproxAddcl2/(i-1))
yy <- mean( c(as.dist((RFproxAddcl2 + (RF2prox[c(1:nrow1),c(1:nrow1)]))/i)))
RFprox2Conver[i,2] <- max(abs(c(as.dist(xx))))
RFprox2Conver[i,3] <- mean((c(as.dist(xx)))^2)
RFprox2Conver[i,4] <- yy
}
RFproxAddcl2 <- RFproxAddcl2 + (RF2prox[c(1:nrow1),c(1:nrow1)])
if(imp) { RFimportance2 <- RFimportance2+ 1/no.rep*(RF2$importance)}
RFerrrate2 <- RFerrrate2+ 1/no.rep*(RF2$err.rate[no.tree])
}
}
}
distRFAddcl1 <- cleandist(sqrt(1-RFproxAddcl1/no.rep))
distRFAddcl2 <- cleandist(sqrt(1-RFproxAddcl2/no.rep))
distRF <- list(cl1=NULL, err1=NULL, imp1=NULL, prox1Conver=NULL,
cl2=NULL, err2=NULL, imp2=NULL, prox2Conver=NULL)
if(addcl1) {
distRF$cl1 <- distRFAddcl1
distRF$err1 <- RFerrrate1
if(imp) distRF$imp1 <- RFimportance1
if(proxConver) distRF$prox1Conver <- RFprox1Conver
}
if(addcl2) {
distRF$cl2 <- distRFAddcl2
distRF$err2 <- RFerrrate2
if(imp) distRF$imp2 <- RFimportance2
if(proxConver) distRF$prox2Conver <- RFprox2Conver
}
distRF
}
distRF <- RFdist(genotypic_climate_cmplt %>% select(Elevation, Latitude, Growth.habit, Seed.color, Seed.shape, Seed.brightness, Seed.weight, wc2.0_bio_30s_01:wc2.0_bio_30s_18) %>% unique(),
mtry1 = 3, no.trees, no.forests, addcl1 = T, addcl2 = F, imp = T, oob.prox1 = T)
?RFdist
RFdist
distRF <- RFdist(datRF = genotypic_climate_cmplt %>% select(Elevation, Latitude, Growth.habit, Seed.color, Seed.shape, Seed.brightness, Seed.weight, wc2.0_bio_30s_01:wc2.0_bio_30s_18) %>% unique(),
mtry1 = 3, no.trees, no.forests, addcl1 = T, addcl2 = F, imp = T, oob.prox1 = T)
head(genotypic_climate_cmplt %>% select(Elevation, Latitude, Growth.habit, Seed.color, Seed.shape, Seed.brightness, Seed.weight, wc2.0_bio_30s_01:wc2.0_bio_30s_18) %>% unique())
head(genotypic_climate_cmplt %>% select(Elevation, Latitude, Growth.habit, Seed.color, Seed.shape, Seed.brightness, Seed.weight, wc2.0_bio_30s_01:wc2.0_bio_30s_18))
names(genotypic_climate_cmplt)
distRF <- RFdist(datRF = genotypic_climate_cmplt %>% select(Elevation, Latitude,
Growth.habit, Seed.color, Seed.shape, Seed.brightness, Seed.weight,
wc2.0_bio_30s_01, wc2.0_bio_30s_05, wc2.0_bio_30s_07, wc2.0_bio_30s_09,
wc2.0_bio_30s_10, wc2.0_bio_30s_14, wc2.0_bio_30s_17, wc2.0_bio_30s_18) %>% unique(),
mtry1 = 3, no.trees, no.forests, addcl1 = T, addcl2 = F, imp = T, oob.prox1 = T)
head(genotypic_climate_cmplt)
head(genotypic_climate_cmplt %>% select(Elevation, Latitude,
Growth.habit, Seed.color, Seed.shape, Seed.brightness, Seed.weight,
wc2.0_bio_30s_01, wc2.0_bio_30s_05, wc2.0_bio_30s_07, wc2.0_bio_30s_09,
wc2.0_bio_30s_10, wc2.0_bio_30s_14, wc2.0_bio_30s_17, wc2.0_bio_30s_18))
distRF <- RFdist(datRF = genotypic_climate_cmplt %>% select(Elevation, Latitude, Growth.habit, Seed.color, Seed.shape, Seed.brightness, Seed.weight, wc2.0_bio_30s_01:wc2.0_bio_30s_18) %>% unique(),
mtry1 = 3, no.trees, no.forests, addcl1 = T, addcl2 = F, imp = T, oob.prox1 = T)
distRF <- RFdist(datRF = genotypic_climate_cmplt %>% as.tibble() %>% select(Elevation, Latitude, Growth.habit, Seed.color, Seed.shape, Seed.brightness, Seed.weight, wc2.0_bio_30s_01:wc2.0_bio_30s_18) %>% unique(),
mtry1 = 3, no.trees, no.forests, addcl1 = T, addcl2 = F, imp = T, oob.prox1 = T)
head(genotypic_climate_cmplt)
genotypic_climate_cmplt %>% as.tibble()
?select
distRF <- RFdist(datRF = genotypic_climate_cmplt %>% as.tibble() %>% dplyr::select(Elevation, Latitude, Growth.habit, Seed.color, Seed.shape, Seed.brightness, Seed.weight, wc2.0_bio_30s_01:wc2.0_bio_30s_18) %>% unique(),
mtry1 = 3, no.trees, no.forests, addcl1 = T, addcl2 = F, imp = T, oob.prox1 = T)
no.forests <- 25
no.trees <- 3000
set.seed(1)
distRF <- RFdist(datRF = genotypic_climate_cmplt[sample(x = 1:nrow(genotypic_climate_cmplt), size = 2000, replace = F),] %>% dplyr::select(Elevation, Latitude, Growth.habit, Seed.color, Seed.shape, Seed.brightness, Seed.weight, wc2.0_bio_30s_01:wc2.0_bio_30s_18) %>% unique(),
mtry1 = 3, no.trees, no.forests, addcl1 = T, addcl2 = F, imp = T, oob.prox1 = T)
suppressMessages(library(cluster))
gower.dist <- daisy(genotypic_climate_cmplt %>% dplyr::select(Elevation, Latitude, Growth.habit, Seed.color, Seed.shape, Seed.brightness, Seed.weight, wc2.0_bio_30s_01:wc2.0_bio_30s_18),
metric = "gower", type = list(logratio = 3))
summary(gower.dist)
gower.mat <- as.matrix(gower.dist)
fviz_dist(gower.mat,
gradient = list(low = "#00AFBB", mid = "white", high = "#FC4E07"))
?get_dist
fviz_dist(as.dist(gower.mat),
gradient = list(low = "#00AFBB", mid = "white", high = "#FC4E07"))
set.seed(1)
gower.dist <- daisy(genotypic_climate_cmplt[sample(x = 1:nrow(genotypic_climate_cmplt), size = 2000, replace = F),] %>% dplyr::select(Elevation, Latitude, Growth.habit, Seed.color, Seed.shape, Seed.brightness, Seed.weight, wc2.0_bio_30s_01:wc2.0_bio_30s_18),
metric = "gower", type = list(logratio = 3))
gower.mat <- as.matrix(gower.dist)
fviz_dist(as.dist(gower.mat),
gradient = list(low = "#00AFBB", mid = "white", high = "#FC4E07"))
options(warn = -1); options(scipen = 999); g <- gc(reset = T); rm(list = ls())
suppressMessages(library(tidyverse))
suppressMessages(library(readxl))
suppressMessages(library(rgdal))
suppressMessages(library(sp))
suppressMessages(library(raster))
suppressMessages(library(ncdf4))
suppressMessages(library(rasterVis))
suppressMessages(library(htmlwidgets))
suppressMessages(library(compiler))
suppressMessages(library(leaflet))
suppressMessages(library(highcharter))
suppressMessages(library(plotly))
suppressMessages(library(d3heatmap))
suppressMessages(library(cluster))
suppressMessages(library(factoextra))
suppressMessages(library(gtools))
coll <- read.csv("D:/ToBackup/climate_and_crop_modelling/cwr-landraces/Input_data/genesys_bean_occ_data_all/coll.csv")
core <- read.csv("D:/ToBackup/climate_and_crop_modelling/cwr-landraces/Input_data/genesys_bean_occ_data_all/core.csv")
geo <- read.csv("D:/ToBackup/climate_and_crop_modelling/cwr-landraces/Input_data/genesys_bean_occ_data_all/geo.csv")
names <- read.csv("D:/ToBackup/climate_and_crop_modelling/cwr-landraces/Input_data/genesys_bean_occ_data_all/names.csv")
names$genesysId <- as.integer(as.character(names$genesysId))
core_geo <- left_join(x = core, y = geo, by = "genesysId")
sum(!is.na(core_geo$longitude & core_geo$latitude))
names_core <- left_join(x = names, y = core, by = "genesysId")
names_core_wout_g <- names_core[-grep(pattern = "^G[0-9]*", names_core$name),]
names_core_wout_g <- names_core_wout_g[-grep(pattern = "^G-[0-9]*", names_core_wout_g$name),]
names_core_wout_g <- names_core_wout_g[-grep(pattern = "^G [0-9]*", names_core_wout_g$name),]
names_core_wout_g <- names_core_wout_g[-grep(pattern = "^PI [0-9]*", names_core_wout_g$name),]
names_core_wout_g <- names_core_wout_g[-grep(pattern = "^W6 [0-9]*", names_core_wout_g$name),]
names_core_wout_g <- names_core_wout_g[-which(!is.na(match(names_core_wout_g$name, coll$collNumb))),]
rownames(names_core_wout_g) <- 1:nrow(names_core_wout_g)
names_core <- left_join(x = names, y = core, by = "genesysId")
names_core_wout_g <- names_core[-grep(pattern = "^G[0-9]*", names_core$name),]
names_core_wout_g <- names_core_wout_g[-grep(pattern = "^G-[0-9]*", names_core_wout_g$name),]
ciat <- read.csv("D:/ToBackup/climate_and_crop_modelling/cwr-landraces/Input_data/CIAT_occ_data_all/coordinates_ciatcsv.csv")
nrow(ciat) # 37987
sum(ciat$Type.of.material == "Landrace", na.rm = T) # 27644
sum(!is.na(ciat$Common.names), na.rm = T) # 37987
sum(ciat$`Type of material` == "Landrace" & !is.na(ciat$`Common names`), na.rm = T) # 17345
names(ciat)
sum(ciat$Type.of.material == "Landrace" & !is.na(ciat$`Common names`), na.rm = T) # 17345
sum(ciat$Type.of.material == "Landrace" & !is.na(ciat$Common.names), na.rm = T) # 17345
head(ciat)
table(ciat$Type.of.material)
library(modelr)
set.seed(1)  # Run to replicate this post
folds <- crossv_kfold(mtcars, k = 5)
folds
View(folds$train$`1`)
View(folds$test$`1`)
dim(mtcars)
rm(folds)
options(warn = -1); options(scipen = 999); g <- gc(reset = T); rm(list = ls())
suppressMessages(library(tidyverse))
suppressMessages(library(readxl))
suppressMessages(library(rgdal))
suppressMessages(library(sp))
suppressMessages(library(raster))
suppressMessages(library(ncdf4))
suppressMessages(library(rasterVis))
suppressMessages(library(htmlwidgets))
suppressMessages(library(compiler))
suppressMessages(library(leaflet))
suppressMessages(library(highcharter))
suppressMessages(library(plotly))
suppressMessages(library(d3heatmap))
suppressMessages(library(cluster))
suppressMessages(library(FactoMineR))
suppressMessages(library(factoextra))
suppressMessages(library(corrplot))
suppressMessages(library(Rtsne))
suppressMessages(library(randomForest))
phenotypic_data <- read_excel(path = "D:/ToBackup/climate_and_crop_modelling/cwr-landraces/Input_data/Blair_et_al_2009_races_subgroups_phenotypic.xlsx", sheet = 2)
View(phenotypic_data)
genotypic_climate <- read.csv("D:/ToBackup/climate_and_crop_modelling/cwr-landraces/Input_data/genotypic_climate.csv")
rm(phenotypic_data)
glimpse(genotypic_climate)
genotypic_climate_cmplt <- genotypic_climate[complete.cases(genotypic_climate),]
genotypic_climate_cmplt <- unique(genotypic_climate_cmplt); rownames(genotypic_climate_cmplt) <- 1:nrow(genotypic_climate_cmplt)
View(genotypic_climate_cmplt)
View(genotypic_climate_cmplt)
boxplot(Elevation ~ Seed.color, data = genotypic_climate_cmplt)
boxplot(Elevation ~ Seed.shape, data = genotypic_climate_cmplt)
boxplot(Elevation ~ Seed.brightness, data = genotypic_climate_cmplt)
plot(genotypic_climate_cmplt$Elevation, genotypic_climate_cmplt$Seed.weight)
plot(genotypic_climate_cmplt$Elevation, genotypic_climate_cmplt$wc2.0_bio_30s_18)
plot(genotypic_climate_cmplt$Elevation, genotypic_climate_cmplt$wc2.0_bio_30s_17)
plot(genotypic_climate_cmplt$Elevation, genotypic_climate_cmplt$wc2.0_bio_30s_14)
plot(genotypic_climate_cmplt$Elevation, genotypic_climate_cmplt$wc2.0_bio_30s_10)
plot(genotypic_climate_cmplt$Elevation, genotypic_climate_cmplt$wc2.0_bio_30s_10, col=rgb(0, 0, 1, 0.5), pch = 20)
set.seed(1)
gower.dist <- daisy(genotypic_climate_cmplt[sample(x = 1:nrow(genotypic_climate_cmplt), size = 2000, replace = F),] %>% dplyr::select(Elevation, Latitude, Growth.habit, Seed.color, Seed.shape, Seed.brightness, Seed.weight, wc2.0_bio_30s_01:wc2.0_bio_30s_18),
metric = "gower", type = list(logratio = 3))
summary(gower.dist)
gower.mat <- as.matrix(gower.dist)
View(genotypic_climate)
fviz_dist(as.dist(gower.mat),
gradient = list(low = "#00AFBB", mid = "white", high = "#FC4E07"))
?daisy
res.hc <- hclust(d = gower.dist, method = "ward.D2")
fviz_dend(res.hc, cex = 0.5)
fviz_dend(res.hc, k = 3, cex = 0.4, horiz = TRUE, k_colors = "jco",
rect = TRUE, rect_border = "jco", rect_fill = TRUE)
options(warn = -1); options(scipen = 999); g <- gc(reset = T); rm(list = ls())
suppressMessages(library(tidyverse))
suppressMessages(library(readxl))
suppressMessages(library(rgdal))
suppressMessages(library(sp))
suppressMessages(library(raster))
suppressMessages(library(ncdf4))
suppressMessages(library(rasterVis))
suppressMessages(library(htmlwidgets))
suppressMessages(library(compiler))
suppressMessages(library(leaflet))
suppressMessages(library(highcharter))
suppressMessages(library(plotly))
suppressMessages(library(d3heatmap))
suppressMessages(library(cluster))
suppressMessages(library(FactoMineR))
suppressMessages(library(factoextra))
suppressMessages(library(corrplot))
suppressMessages(library(Rtsne))
suppressMessages(library(randomForest))
genotypic_climate <- read.csv("D:/ToBackup/climate_and_crop_modelling/cwr-landraces/Input_data/genotypic_climate.csv")
glimpse(genotypic_climate)
genotypic_climate_cmplt <- genotypic_climate[complete.cases(genotypic_climate),]
genotypic_climate_cmplt <- unique(genotypic_climate_cmplt); rownames(genotypic_climate_cmplt) <- 1:nrow(genotypic_climate_cmplt)
set.seed(1)
gower.dist <- daisy(genotypic_climate_cmplt[sample(x = 1:nrow(genotypic_climate_cmplt), size = 2000, replace = F),] %>% dplyr::select(Elevation, Latitude, Growth.habit, Seed.color, Seed.shape, Seed.brightness, Seed.weight, wc2.0_bio_30s_01:wc2.0_bio_30s_18),
metric = "gower", type = list(logratio = 3))
summary(gower.dist)
gower.mat <- as.matrix(gower.dist)
hist(gower.dist)
ecdfplot(gower.dist)
ecdfplot(as.numeric(gower.dist))
R.Version()
library(dplyr)
unite_(mtcars, "vs_am", c("vs","am"))
head(mtcars\)
head(mtcars)
library(FactoMineR)
?HCPC
tabla <- readRDS("file:///C:/Users/haachicanoy/Documents/CIAT/Asesorias/Lisset_Perez/Agroclimas/extractedDataFrom2006_niceFormat.RDS")
tabla <- readRDS("C:/Users/haachicanoy/Documents/CIAT/Asesorias/Lisset_Perez/Agroclimas/extractedDataFrom2006_niceFormat.RDS")
View(tabla)
res.hc <- hclust(d = gower.dist, method = "ward.D2")
fviz_dend(res.hc, cex = 0.5)
res.hc$height
barplot(res.hc$height)
View(genotypic_climate_cmplt)
library(cluster)
install.packages("ClustOfVar")
install.packages("vegan")
library(ClustOfVar)
library(ClustOfVar)
stability(tree = res.hc, B = 40, graph = T)
fviz_nbclust(genotypic_climate_cmplt[sample(x = 1:nrow(genotypic_climate_cmplt), size = 2000, replace = F),] %>% dplyr::select(Elevation, Latitude, Growth.habit, Seed.color, Seed.shape, Seed.brightness, Seed.weight, wc2.0_bio_30s_01:wc2.0_bio_30s_18),
kmeans, method = "wss") + geom_vline(xintercept = 4, linetype = 2) +
labs(subtitle = "Elbow method")
?fviz_nbclust
fviz_nbclust(genotypic_climate_cmplt[sample(x = 1:nrow(genotypic_climate_cmplt), size = 2000, replace = F),] %>% dplyr::select(Elevation, Latitude, Growth.habit, Seed.color, Seed.shape, Seed.brightness, Seed.weight, wc2.0_bio_30s_01:wc2.0_bio_30s_18),
kmeans, method = "gap_stat") + geom_vline(xintercept = 4, linetype = 2) +
labs(subtitle = "Elbow method")
genotypic_climate_cmplt[sample(x = 1:nrow(genotypic_climate_cmplt), size = 2000, replace = F),] %>% dplyr::select(Elevation, Latitude, Growth.habit, Seed.color, Seed.shape, Seed.brightness, Seed.weight, wc2.0_bio_30s_01:wc2.0_bio_30s_18) %>% View()
apply(X = genotypic_climate_cmplt, MARGIN = 2, FUN = is.numeric())
apply(X = genotypic_climate_cmplt, MARGIN = 2, FUN = is.numeric)
data("iris")
head(iris)
pairs(iris[,1:4])
iris[,1:4] %>% cor(method = "pearson")
iris[,1:4] %>% scale %>% cor(method = "pearson")
iris[,1:4] %>% scale %>% head()
plot(genotypic_climate$Longitude, genotypic_climate$Latitude, pch=20)
library(PCAmixdata)
View(iris)
library(mvoutlier)
install.packages("mvoutlier")
library("mvoutlier", lib.loc="~/R/win-library/3.4")
data(humus)
humus %>% head
humus %>% cor(method = "pearson")
d <- humus[,c("As","Cd","Co","Cu","Mg","Pb","Zn")]
pairs(d)
res <- mvoutlier.CoDa(d)
res
str(res)
plot(res,onlyout=TRUE,which="biplot",bw=FALSE,symb=TRUE,symbtxt=TRUE)
install.packages(c("diagram", "httr", "NLP", "plotrix", "rmapshaper", "robCompositions", "shape", "shiny"))
options(warn = -1); options(scipen = 999); g <- gc(reset = T); rm(list = ls())
suppressMessages(library(tidyverse))
suppressMessages(library(readxl))
suppressMessages(library(rgdal))
suppressMessages(library(sp))
suppressMessages(library(raster))
suppressMessages(library(ncdf4))
suppressMessages(library(rasterVis))
suppressMessages(library(htmlwidgets))
suppressMessages(library(compiler))
suppressMessages(library(leaflet))
suppressMessages(library(highcharter))
suppressMessages(library(plotly))
suppressMessages(library(d3heatmap))
suppressMessages(library(cluster))
suppressMessages(library(FactoMineR))
suppressMessages(library(factoextra))
suppressMessages(library(corrplot))
suppressMessages(library(Rtsne))
suppressMessages(library(randomForest))
genotypic_climate <- read.csv("D:/ToBackup/climate_and_crop_modelling/cwr-landraces/Input_data/genotypic_climate.csv")
glimpse(genotypic_climate)
genotypic_climate_cmplt <- genotypic_climate[complete.cases(genotypic_climate),]
genotypic_climate_cmplt <- unique(genotypic_climate_cmplt); rownames(genotypic_climate_cmplt) <- 1:nrow(genotypic_climate_cmplt)
genotypic_climate_cmplt %>% dplyr::select(Elevation, Longitude, Latitude, Seed.weight, wc2.0_bio_30s_01:wc2.0_bio_30s_18) %>%
gather(Variable, Value) %>% ggplot(aes(x = Value, fill = Variable, alpha = .6)) +
geom_density() +
facet_wrap(~ Variable, scales = "free") +
theme_bw() +
theme(legend.position = "bottom") +
theme(legend.title = element_text(face = "bold")) +
guides(alpha = F, fill = F) +
theme(strip.text = element_text(size = 12, face = "bold")) +
theme(axis.title.x = element_text(size = 13, face = 'bold'),
axis.title.y = element_text(size = 13, face = 'bold'),
axis.text = element_text(size = 12))
genotypic_climate_cmplt %>% dplyr::select(Elevation, Longitude, Latitude, Seed.weight, wc2.0_bio_30s_01:wc2.0_bio_30s_18) %>%
gather(Variable, Value) %>% ggplot(aes(x = Value, fill = Variable, alpha = .6)) +
geom_histogram() +
facet_wrap(~ Variable, scales = "free") +
theme_bw() +
theme(legend.position = "bottom") +
theme(legend.title = element_text(face = "bold")) +
guides(alpha = F, fill = F) +
theme(strip.text = element_text(size = 12, face = "bold")) +
theme(axis.title.x = element_text(size = 13, face = 'bold'),
axis.title.y = element_text(size = 13, face = 'bold'),
axis.text = element_text(size = 12))
genotypic_climate %>% glimpse
genotypic_climate_cmplt %>% dplyr::select(Elevation, Longitude, Latitude, Seed.weight, wc2.0_bio_30s_01:wc2.0_bio_30s_18) %>%
psych::describe() %>% select(mean, sd, median, min, max, range)
genotypic_climate_cmplt %>% dplyr::select(Growth.habit, Seed.color, Seed.shape, Seed.brightness, Owner) %>%
gather(measure, value) %>%
count(measure, value) %>%
spread(measure, n) %>% head
genotypic_climate_cmplt %>% dplyr::select(Growth.habit, Seed.color, Seed.shape, Seed.brightness, Owner) %>%
gather(measure, value) %>%
count(measure, value) %>%
spread(measure, n) %>%
gather(key = Variable, value = Count, Growth.habit:Seed.shape) %>% head
fqTable <- genotypic_climate_cmplt %>% dplyr::select(Growth.habit, Seed.color, Seed.shape, Seed.brightness, Owner) %>%
gather(measure, value) %>%
count(measure, value) %>%
spread(measure, n) %>%
gather(key = Variable, value = Count, Growth.habit:Seed.shape) %>% head
fqTable %>% ggplot(aes(x = Category, y = Percentage*100)) +
geom_bar(stat = "identity") +
xlab("") + ylab("Porcentaje (%)") +
coord_flip() +
facet_wrap(~ Variable, scales = "free") +
theme_bw() +
theme(strip.text = element_text(size = 12, face = "bold")) +
theme(axis.title.x = element_text(size = 13, face = 'bold'),
axis.title.y = element_text(size = 13, face = 'bold'),
axis.text = element_text(size = 12))
fqTable <- genotypic_climate_cmplt %>% dplyr::select(Growth.habit, Seed.color, Seed.shape, Seed.brightness, Owner) %>%
gather(measure, value) %>%
count(measure, value) %>%
spread(measure, n) %>%
gather(key = Variable, value = Count, Growth.habit:Seed.shape)
fqTable <- fqTable[complete.cases(fqTable),]; rownames(fqTable) <- 1:nrow(fqTable); colnames(fqTable)[1] <- "Category"
fqTable <- fqTable %>% dplyr::mutate(Percentage = Count/nrow(df))
View(fqTable)
View(fqTable)
fqTable %>% dplyr::mutate(Percentage = Count/nrow(df))
fqTable <- fqTable %>% dplyr::mutate(Percentage = Count/nrow(genotypic_climate_cmplt))
View(fqTable)
fqTable %>% ggplot(aes(x = Category, y = Percentage*100)) +
geom_bar(stat = "identity") +
xlab("") + ylab("Percentage (%)") +
coord_flip() +
facet_wrap(~ Variable, scales = "free") +
theme_bw() +
theme(strip.text = element_text(size = 12, face = "bold")) +
theme(axis.title.x = element_text(size = 13, face = 'bold'),
axis.title.y = element_text(size = 13, face = 'bold'),
axis.text = element_text(size = 12))
options(warn = -1); options(scipen = 999); g <- gc(reset = T); rm(list = ls())
# Load packages
suppressMessages(library(tidyverse))
suppressMessages(library(readxl))
suppressMessages(library(rgdal))
suppressMessages(library(sp))
suppressMessages(library(raster))
suppressMessages(library(ncdf4))
suppressMessages(library(rasterVis))
suppressMessages(library(htmlwidgets))
suppressMessages(library(compiler))
suppressMessages(library(leaflet))
suppressMessages(library(highcharter))
suppressMessages(library(plotly))
suppressMessages(library(d3heatmap))
suppressMessages(library(cluster))
suppressMessages(library(FactoMineR))
suppressMessages(library(factoextra))
suppressMessages(library(corrplot))
suppressMessages(library(Rtsne))
suppressMessages(library(randomForest))
genotypic_climate <- read.csv("D:/ToBackup/climate_and_crop_modelling/cwr-landraces/Input_data/genotypic_climate.csv")
genotypic_climate %>% glimpse
genotypic_climate_cmplt <- genotypic_climate[complete.cases(genotypic_climate),]
genotypic_climate_cmplt <- unique(genotypic_climate_cmplt); rownames(genotypic_climate_cmplt) <- 1:nrow(genotypic_climate_cmplt)
fqTable %>% ggplot(aes(x =  reorder(Category, -Percentage), y = Percentage*100)) +
geom_bar(stat = "identity") +
xlab("") + ylab("Percentage (%)") +
coord_flip() +
facet_wrap(~ Variable, scales = "free") +
theme_bw() +
theme(strip.text = element_text(size = 12, face = "bold")) +
theme(axis.title.x = element_text(size = 13, face = 'bold'),
axis.title.y = element_text(size = 13, face = 'bold'),
axis.text = element_text(size = 12))
fqTable <- genotypic_climate_cmplt %>% dplyr::select(Growth.habit, Seed.color, Seed.shape, Seed.brightness, Owner) %>%
gather(measure, value) %>%
count(measure, value) %>%
spread(measure, n) %>%
gather(key = Variable, value = Count, Growth.habit:Seed.shape)
fqTable <- fqTable[complete.cases(fqTable),]; rownames(fqTable) <- 1:nrow(fqTable); colnames(fqTable)[1] <- "Category"
fqTable <- fqTable %>% dplyr::mutate(Percentage = Count/nrow(genotypic_climate_cmplt))
fqTable %>% ggplot(aes(x =  reorder(Category, -Percentage), y = Percentage*100)) +
geom_bar(stat = "identity") +
xlab("") + ylab("Percentage (%)") +
coord_flip() +
facet_wrap(~ Variable, scales = "free") +
theme_bw() +
theme(strip.text = element_text(size = 12, face = "bold")) +
theme(axis.title.x = element_text(size = 13, face = 'bold'),
axis.title.y = element_text(size = 13, face = 'bold'),
axis.text = element_text(size = 12))
fqTable %>% ggplot(aes(x =  reorder(Category, Percentage), y = Percentage*100)) +
geom_bar(stat = "identity") +
xlab("") + ylab("Percentage (%)") +
coord_flip() +
facet_wrap(~ Variable, scales = "free") +
theme_bw() +
theme(strip.text = element_text(size = 12, face = "bold")) +
theme(axis.title.x = element_text(size = 13, face = 'bold'),
axis.title.y = element_text(size = 13, face = 'bold'),
axis.text = element_text(size = 12))
genotypic_climate_cmplt %>% dplyr::select(Elevation, Longitude, Latitude, Seed.weight, wc2.0_bio_30s_01:wc2.0_bio_30s_18) %>%
gather(Variable, Value) %>% ggplot(aes(x = Value, fill = Variable, alpha = .6)) +
geom_histogram() +
facet_wrap(~ Variable, scales = "free") +
theme_bw() +
theme(legend.position = "bottom") +
theme(legend.title = element_text(face = "bold")) +
guides(alpha = F, fill = F) +
theme(strip.text = element_text(size = 12, face = "bold")) +
theme(axis.title.x = element_text(size = 13, face = 'bold'),
axis.title.y = element_text(size = 13, face = 'bold'),
axis.text = element_text(size = 12))
View(genotypic_climate_cmplt)
install.packages("MVN")
install.packages("referenceIntervals")
library("referenceIntervals")
library("referenceIntervals")
library("referenceIntervals")
options(warn = -1); options(scipen = 999); g <- gc(reset = T); rm(list = ls())
options(warn = -1); options(scipen = 999); g <- gc(reset = T); rm(list = ls())
suppressMessages(library(tidyverse))
suppressMessages(library(readxl))
suppressMessages(library(rgdal))
suppressMessages(library(sp))
suppressMessages(library(raster))
suppressMessages(library(ncdf4))
suppressMessages(library(rasterVis))
suppressMessages(library(htmlwidgets))
suppressMessages(library(compiler))
suppressMessages(library(leaflet))
suppressMessages(library(highcharter))
suppressMessages(library(plotly))
suppressMessages(library(d3heatmap))
suppressMessages(library(cluster))
suppressMessages(library(factoextra))
suppressMessages(library(gtools))
options(warn = -1); options(scipen = 999); g <- gc(reset = T); rm(list = ls())
OSys <- Sys.info(); OSys <- OSys[names(OSys)=="sysname"]
if(OSys == "Linux"){ root <- "/mnt" } else {
if(OSys == "Windows"){ root <- "//dapadfs" }
}; rm(OSys)
options(warn = -1); options(scipen = 999); g <- gc(reset = T); rm(list = ls())
OSys <- Sys.info(); OSys <- OSys[names(OSys)=="sysname"]
if(OSys == "Linux"){ root <- "/mnt/workspace_cluster_9" } else {
if(OSys == "Windows"){ root <- "//dapadfs/Workspace_cluster_9" }
}; rm(OSys)
root
ciat <- read.csv("//dapadfs/Workspace_cluster_9/gap_analysis_landraces/Input_data/_ocurrence_data/_ciat_data/Bean/BEAN-GRP-CIAT.csv")
root
paste0(root, "/gap_analysis_landraces/Input_data/_ocurrence_data/_ciat_data/Bean/BEAN-GRP-CIAT.csv")
mapspam <- raster::brick(paste0(root, "/gap_analysis_landraces/Input_data/_crop_areas/MapSPAM/Bean/spam2005v2r0_harvested-area_bean_total.nc"), lvar = 4)
mapspam <- mapspam[[1]]
plot(mapspam)
options(warn = -1); options(scipen = 999); g <- gc(reset = T); rm(list = ls())
OSys <- Sys.info(); OSys <- OSys[names(OSys)=="sysname"]
if(OSys == "Linux"){ root <- "/mnt/workspace_cluster_9" } else {
if(OSys == "Windows"){ root <- "//dapadfs/Workspace_cluster_9" }
}; rm(OSys)
suppressMessages(library(tidyverse))
suppressMessages(library(readxl))
suppressMessages(library(rgdal))
suppressMessages(library(sp))
suppressMessages(library(raster))
suppressMessages(library(ncdf4))
suppressMessages(library(rasterVis))
suppressMessages(library(htmlwidgets))
suppressMessages(library(compiler))
suppressMessages(library(leaflet))
suppressMessages(library(highcharter))
suppressMessages(library(plotly))
suppressMessages(library(d3heatmap))
suppressMessages(library(cluster))
suppressMessages(library(factoextra))
suppressMessages(library(gtools))
